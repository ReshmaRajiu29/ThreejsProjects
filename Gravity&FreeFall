<!DOCTYPE html>
<html>
<head>
  <title>Catch the Falling Ball - Physics Game</title>
  <style>
    body { margin: 0; overflow: hidden; background: #222; color: #fff; font-family: Arial; }
    canvas { display: block; background: #333; }
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      color: #fff;
      font-size: 20px;
      text-align: center;
      padding: 20px;
      z-index: 10;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Start Popup -->
  <div id="startOverlay" class="overlay">
    <h1>Catch the Falling Ball Game</h1>
    <p>Rules:</p>
    <ul>
      <li>The ball falls from top due to gravity (free fall).</li>
      <li>Use <b>Left</b> and <b>Right</b> arrow keys to move the catcher.</li>
      <li>Catch the ball to score points.</li>
      <li>If you miss the ball, the game ends.</li>
    </ul>
    <button onclick="startGame()">Start Game</button>
  </div>

  <!-- Game Over Popup -->
  <div id="endOverlay" class="overlay" style="display:none;">
    <h1>Game Over!</h1>
    <p id="endMessage">
      You missed the ball.<br><br>
      Physics Explanation:<br>
      The ball falls due to gravity, the force pulling it toward the Earth (catcher). 
      Its downward motion is called free fall, caused only by gravity. 
      The catcher acts like the Earth pulling the ball down, while the ball moves freely under this force.
    </p>
    <button onclick="restartGame()">Play Again</button>
  </div>

  <div id="info">Time: 0 s | Velocity: 0 m/s | Height: 400 m | Score: 0</div>
  <canvas id="gameCanvas"></canvas>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let ball = { x: canvas.width/2, y: 50, radius: 30, vy: 0 };
    let catcher = { x: canvas.width/2 - 50, y: canvas.height - 40, width: 100, height: 20, speed: 15 };
    let g = 2; // slower gravity
    let height = canvas.height - ball.y; 
    let time = 0;
    let dt = 0.02; 
    let score = 0;
    let gameRunning = false;

    const keys = {};
    window.addEventListener('keydown', e => keys[e.key] = true);
    window.addEventListener('keyup', e => keys[e.key] = false);

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw ball
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI*2);
      ctx.fillStyle = 'orange';
      ctx.fill();
      ctx.closePath();

      // Draw catcher
      ctx.fillStyle = 'lightblue';
      ctx.fillRect(catcher.x, catcher.y, catcher.width, catcher.height);
    }

    function update() {
      if(!gameRunning) return;

      // Ball motion
      ball.vy += g * dt;
      ball.y += ball.vy;

      height = Math.max(0, canvas.height - ball.y);
      time += dt;

      // Catcher movement
      if(keys['ArrowLeft'] && catcher.x > 0) catcher.x -= catcher.speed;
      if(keys['ArrowRight'] && catcher.x + catcher.width < canvas.width) catcher.x += catcher.speed;

      // Collision detection with catcher
      if(ball.y + ball.radius >= catcher.y &&
         ball.x >= catcher.x &&
         ball.x <= catcher.x + catcher.width) {
        score++;
        resetBall();
      }

      // Ball hits the ground â†’ Game Over
      if(ball.y + ball.radius > canvas.height){
        gameRunning = false;
        document.getElementById('endOverlay').style.display = 'flex';
      }

      // Update info
      document.getElementById('info').innerText = 
        `Time: ${time.toFixed(2)} s | Velocity: ${ball.vy.toFixed(2)} m/s | Height: ${height.toFixed(2)} m | Score: ${score}`;
    }

    function resetBall() {
      ball.y = 50;
      ball.x = Math.random() * (canvas.width - 60) + 30;
      ball.vy = 0;
      height = canvas.height - ball.y;
    }

    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    function startGame() {
      document.getElementById('startOverlay').style.display = 'none';
      document.getElementById('endOverlay').style.display = 'none';
      gameRunning = true;
      time = 0;
      score = 0;
      resetBall();
    }

    function restartGame() {
      startGame();
    }

    loop();
  </script>
</body>
</html>
